files:
  "/etc/cron.d/sete":
    mode: "000644"
    owner: root
    group: root
    content: |
      * * * * * root /usr/local/bin/cron-script.sh

  "/usr/local/bin/cron-script.sh":
    mode: "000755"
    owner: root
    group: root
    content: |
      #!/bin/bash

      date > /tmp/date
      # generate forecasts
      30 0 1 1-12 * curl --location --request POST 'http://127.0.0.1:8080/v1/sete/forecast/reports/generate' --header 'Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJlbWFpbCI6ImFyYXZpbmRhY2xvdWRAZ21haWwuY29tIiwiYWNjb3VudE51bWJlciI6NDMwMzM4MDkxMiwiaWF0IjoxNjA2Nzk2MDU2fQ.Ma0H84Ksh4G9paShrcNrrcqGySJ9EtSZOLLTAWHoav0'
      # generate monthly reports
      * * * 1-12 * curl --location --request POST 'http://127.0.0.1:8080/v1/sete/analysis/reports/generate' --header 'Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJlbWFpbCI6ImFyYXZpbmRhY2xvdWRAZ21haWwuY29tIiwiYWNjb3VudE51bWJlciI6NDMwMzM4MDkxMiwiaWF0IjoxNjA2Nzk2MDU2fQ.Ma0H84Ksh4G9paShrcNrrcqGySJ9EtSZOLLTAWHoav0'
      # dispatch monthly reports
      30 9 1 1-12 * curl --location --request POST 'http://127.0.0.1:8080/v1/sete/analysis/reports/dispatch' --header 'Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJlbWFpbCI6ImFyYXZpbmRhY2xvdWRAZ21haWwuY29tIiwiYWNjb3VudE51bWJlciI6NDMwMzM4MDkxMiwiaWF0IjoxNjA2Nzk2MDU2fQ.Ma0H84Ksh4G9paShrcNrrcqGySJ9EtSZOLLTAWHoav0'
      exit 0

commands:
  remove_old_cron:
    command: "rm -f /etc/cron.d/sete.bak"
